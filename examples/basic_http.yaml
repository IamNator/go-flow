vars:
  base_url: http://localhost:8080/api/v1
  auth_token: dev-token

steps:
  - name: create-user
    method: POST
    url: "{{.base_url}}/users"
    headers:
      Content-Type: application/json
      Authorization: "Bearer {{.auth_token}}"
    body: |
      {
        "email": "{{randomEmail}}",
        "name": "{{randomName}}",
        "phone": "{{randomPhone}}"
      }
    expect_status: 201
    save:
      user_id: data.id
      user_email: data.email

  - name: fetch-user
    method: GET
    url: "{{.base_url}}/users/{{.user_id}}"
    headers:
      Authorization: "Bearer {{.auth_token}}"
    expect_status: 200
    save:
      user_name: data.name

  - name: delete-user
    method: DELETE
    url: "{{.base_url}}/users/{{.user_id}}"
    headers:
      Authorization: "Bearer {{.auth_token}}"
    expect_status: 204
